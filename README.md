# 레포지터리 개요

이 레포지터리는 "사용자 트래킹 디스플레이" 프로젝트의 코드를 포함합니다.

_RESULT 폴더에 최종 코드가 포함되어 있습니다.

## 폴더 구조

- **_CHAINGING**: 실시간으로 수정 중인 코드 모음입니다.
- **_CODES**: 백업용 코드로, 크게 중요하지 않습니다.
- **_COMMENTS**: 개념 설명을 위한 주석이 달린 코드로, 크게 중요하지 않습니다.
- **_RESULT**: 최종 코드 모음입니다. 주로 이 폴더를 확인하시면 됩니다.
- **_TRIAL_N_ERROR**: 시행착오 과정에서의 코드로, 크게 중요하지 않습니다.
- **_VIDEO**: 프로젝트에서 사용된 360도 비디오 모음입니다.

### _RESULT 폴더 내부

_RESULT 폴더는 이 레포지터리에서 가장 중요한 폴더입니다.

다음과 같은 다섯 개의 하위 폴더를 포함하고 있습니다:
- **0**: 도대회 발표 때 시연하기 위해 사용한 코드들입니다.
- **1~3**: 기존 NFoV에서 dxdydz를 반영해가는 코드들입니다.
- **4**: 투영 시뮬레이션 코드들입니다.


## 설치 안내
### 가상환경 설정
해당 프로젝트를 위한 가상환경을 생성하고자 하신다면, 아래의 방법을 따라주시면 됩니다.
1. VScode에서 이 프로젝트를 위한 폴더 하나 만들기
2. Ctrl + Shift + ` → cmd 창 열기
3. 아래의 코드로 가상 환경 생성하기 (VENV는 가상환경 이름)

    ```bash
    python -m venv VENV
    ```

4. 아래의 코드로 가상 환경 활성화하기

    ```bash
    .\VENV\Scripts\activate
    ```

    → 해당 코드 실행 후, 터미널 프롬프트 앞에 가상 환경 이름이 나타나야 합니다.
   
      ```예: (VENV) D:\W00Y0NG\PRGM2\360WINDOW>```
   
      나타나지 않을 경우 아래의 과정 추가 진행해 주세요.

6. (+) Ctrl + Shift + P → Command Palette 열기
7. (+) Select Interpreter 입력하여 "Python: Select Interpreter" 선택하기
8. (+) 설치된 python 인터프리터 목록 중, 내가 생성한 가상 환경 선택하기


### 필요한 라이브러리

### 필요한 라이브러리

이 레포지터리의 코드를 사용하기 위해 아래와 같이 라이브러리를 설치해야 합니다.

```bash
pip install numpy opencv-python-headless matplotlib
```

## 실행 안내

### 사용자 트래킹 후 360 회전

코드 실행 시, 비디오를 저장한 개인의 경로에 맞게 코드 내의 `video path`를 조정해야 합니다.
```python
video_path = r'D:\W00Y0NG\PRGM2\360WINDOW\2024video360\_VIDEO\0604_black_win.mp4'
```
360 video는 _VIDEO에서 저장하실 수 있습니다.

이 레포지터리의 코드들은 class 정의 부분과 main 실행 부분으로 나뉩니다.

전반적으로 **nfov과 face_landmark 코드**는 **class 정의 부분**,

**demo 코드**는 위의 class에서 정의한 함수를 사용해 작업을 수행하는 **main 실행 부분**입니다.


이 레포지터리에서 주로 열고 실행해야 하는 파일은 다음과 같습니다.

#### <실행해야 하는 파일>

(_RESULT -> 0 -> 2)
- `0609_crop_demo.py`: 해당 파일만 실행하시면 됩니다. crop을 원치 않는 경우, 55번 line을 주석처리 하시면 됩니다.
- `com_face_landmark.py`: 얼굴 랜드마크 감지 classdp 주석을 달아놓은 코드입니다.
- `com_nfov.py`: 기존 NFoV class에 주석을 달아놓은 코드입니다.

세 파일을 한 폴더 안에 두고, demo 파일을 실행하셔야 합니다. 

### 360 투영 시뮬레이션
아래의 파라미터로 구의 반경, 창문의 크기, x축 이동량, y축 이동량을 정의합니다.

해당 변수의 값을 필요에 따라 수정하여 사용하시면 됩니다.
```ptyon
R = 30
box_size = 10
half_size = box_size / 2
dx = 5
dy = -70
```


두 위치를 비교하는 게 아닌, 더 많은 위치를 비교하고 싶으시다면 `positions` 변수 안에 좌표를 추가하시면 됩니다.


좌표는 아래와 같이 추가하실 수 있습니다.


```python
positions = [
    np.array([0, 0, 0]),
    np.array([dx, 0, 0]),
    np.array([0, dy, 0]),
    .
    .
    .
]
```

#### <실행해야 하는 파일>

(_RESULT -> 4)
- `3Dwindow.py`: 아래의 결과를 확인하실 수 있습니다.
  ![image](https://github.com/wooyong8969/2024video360/assets/73220509/614c8593-ddf2-4438-81f3-94fdbf6df6c8)
- `0602_3Dwindow.py`: dy 라인에서 dx 만큼 이동 시 변화하는 시야각을 계산하는 코드입니다.
                      3D window에서 시야각만 추가한 것으로, 시뮬레이션 종료 시 터미널에 시야각이 출력됩니다.

  

## 추가 사항

문제가 발생하거나 추가 지침이 필요한 경우, 각 코드 파일 내의 주석을 참조하거나 레포지터리 관리자(우용)에게 연락해 주세요.

